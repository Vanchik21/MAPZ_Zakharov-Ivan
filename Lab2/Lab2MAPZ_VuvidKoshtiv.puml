@startuml
|Клієнт|
start
:Ініціювати виведення коштів;
:Ввести суму та платіжні реквізити;

|Система|
if (Чи достатньо коштів на балансі?) then (так)
  :Створити заявку на виведення (Status='Pending');
  
  |База даних|
  :Заморозити суму на балансі клієнта;
  
  |Система|
  if (Сума перевищує ліміт авто-виведення?) then (так)
    :Надіслати заявку на ручне підтвердження;
    
    |Фінансовий відділ|
    :Розглянути заявку;
    if (Заявку підтверджено?) then (так)
      |Система|
      :Отримати підтвердження;
    else (ні)
      |Система|
      :Отримати відмову;
      
      |База даних|
      :Розморозити суму на балансі клієнта;
      :Оновити статус заявки на 'Rejected';

      |Система|
      :Повідомити клієнта про відмову;
      stop
    endif
  endif
  
  |Система|
  :Надіслати запит на виплату до платіжної системи;
  
  |База даних|
  :Списати заморожену суму з балансу;
  :Оновити статус заявки на 'Completed';
  
  |Система|
  :Повідомити клієнта про успішну виплату;
  
  |Клієнт|
  :Отримати сповіщення;

else (ні)
  |Система|
  :Повідомити про недостатність коштів;
  
  |Клієнт|
  :Отримати повідомлення про помилку;
endif

stop
@enduml